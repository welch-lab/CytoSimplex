<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create ternary simplex plots — plotTernary • CytoSimplex</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create ternary simplex plots — plotTernary"><meta name="description" content="Create ternary plots that show similarity between single cells and
selected three terminals in a ternary baricentric coordinate."><meta property="og:description" content="Create ternary plots that show similarity between single cells and
selected three terminals in a ternary baricentric coordinate."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytoSimplex</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/hspc_example.html">HSPC analysis</a></li>
    <li><a class="dropdown-item" href="../articles/CytoSimplex.html">General usage with BMSC subset</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">API</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://welch-lab.github.io/">Welch Lab</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/welch-lab/CytoSimplex"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/LabWelch"><span class="fa fab fa-twitter fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create ternary simplex plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/welch-lab/CytoSimplex/blob/HEAD/R/ternary.R" class="external-link"><code>R/ternary.R</code></a></small>
      <div class="d-none name"><code>plotTernary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create ternary plots that show similarity between single cells and
selected three terminals in a ternary baricentric coordinate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotTernary</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">plotTernary</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">clusterVar</span>,</span>
<span>  <span class="va">vertices</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  veloGraph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  byCluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"cosine"</span>, <span class="st">"pearson"</span>, <span class="st">"spearman"</span><span class="op">)</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dotColorBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dotColor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>  direction <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legendTitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnData <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Input data. Can be a <code>matrix</code> or <code>dgCMatrix</code> object with
cells as columns, a <code>Seurat</code> or <code>SingleCellExperiment</code> object.
"simMat" method takes intermediate values.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="plotTernary.simMat.html">plotTernary.simMat</a></code></p><dl><dt><code>title</code></dt>
<dd><p>Title text of the plot. Default <code>NULL</code>.</p></dd>

    <dt><code>nGrid</code></dt>
<dd><p>Number of grids along the bottom side of the equilateral
triangle. Default <code>10</code>.</p></dd>

    <dt><code>radius</code></dt>
<dd><p>Arrow length of unit velocity. Lower this when arrows point
outside of the coordinate. Default <code>0.1</code>.</p></dd>

    <dt><code>dotSize</code></dt>
<dd><p>Dot aesthetics passed to <code>geom_point</code>. Default <code>0.6</code>
when not interactive, <code>4</code> when interactive.</p></dd>

    <dt><code>dotShuffle</code></dt>
<dd><p>Whether to shuffle the order of dots being added to the
plot, useful when categorical colors are used and mixing of categories is
expected. Default <code>NULL</code> does shuffle when <code>dotColorBy</code> given is
categorical and does not otherwise.</p></dd>

    <dt><code>labelColors</code></dt>
<dd><p>Colors of the axis lines and vertex labels.
Default <code>c("#3B4992FF", "#EE0000FF", "#008B45FF")</code> (blue, red and green)</p></dd>

    <dt><code>vertexLabelSize</code></dt>
<dd><p>Size of vertex labels. Default <code>6</code> when not
interactive, <code>16</code> when interactive.</p></dd>

    <dt><code>vertexLabelDrift</code></dt>
<dd><p>Position adjustment of the vertex labels, only
applied to non-interactive view. Default <code>0.03</code>.</p></dd>

    <dt><code>axisBreak</code></dt>
<dd><p>Number of breaks to be labeled along axis. Default
<code>5</code>.</p></dd>

    <dt><code>axisTextShow</code></dt>
<dd><p>Logical, whether to show axis text. Default <code>TRUE</code>.</p></dd>

    <dt><code>axisTextSize</code></dt>
<dd><p>Size of text along each axis break. Default <code>4</code> for
non-interactive view, <code>12</code> for interactive view.</p></dd>

    <dt><code>axisTextDrift</code></dt>
<dd><p>Position adjustment of the axis text, only applied to
non-interactive view. Default <code>0.01</code>.</p></dd>

    <dt><code>gridLineAlpha</code></dt>
<dd><p>Transparency of background grid lines. Default
<code>0.6</code>.</p></dd>

    <dt><code>arrowLinewidth</code></dt>
<dd><p>Line width of the velocity arrows. Default <code>0.25</code>
for non-interactive view, <code>2</code> for interactive view.</p></dd>

    <dt><code>arrowAngle</code></dt>
<dd><p>Controls the angle of the arrowhead, only applied to
non-interactive view. Default <code>20</code>.</p></dd>

    <dt><code>arrowLen</code></dt>
<dd><p>Control length in centimetre from arrow tip to arrow tail,
only applied to non-interactive view. Default <code>0.2</code>.</p></dd>

    <dt><code>titleSize</code></dt>
<dd><p>Size of title text. Default <code>14</code> for non-interactive
view, <code>20</code> for interactive view.</p></dd>

    <dt><code>equilateral</code></dt>
<dd><p>Logical, whether to always display the triangle as
equilateral. Default <code>TRUE</code>.</p></dd>

    <dt><code>margin</code></dt>
<dd><p>Margin allowed around of the triangle plotting region when
<code>equilateral = TRUE</code></p></dd>

    <dt><code>interactive</code></dt>
<dd><p>Logical. Whether to display plotly interactive view.
Default <code>FALSE</code>.</p></dd>


</dl></dd>


<dt id="arg-clustervar">clusterVar<a class="anchor" aria-label="anchor" href="#arg-clustervar"></a></dt>
<dd><p>A vector/factor assigning the cluster variable to each
column of the matrix object. For "Seurat" method, <code>NULL</code> (default) for
<code>Idents(x)</code>, or a variable name in <code>meta.data</code> slot. For
"SingleCellExperiment" method, <code>NULL</code> (default) for <code>colLabels(x)</code>,
or a variable name in <code>colData</code> slot.</p></dd>


<dt id="arg-vertices">vertices<a class="anchor" aria-label="anchor" href="#arg-vertices"></a></dt>
<dd><p>Vector of three unique cluster names that will be used for
plotting. Or a named list that groups clusters as three terminal vertices.
There must not be any overlap between groups.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>Valid matrix row subsetting index to select features for
similarity calculation. Default <code>NULL</code> uses all available features.</p></dd>


<dt id="arg-velograph">veloGraph<a class="anchor" aria-label="anchor" href="#arg-velograph"></a></dt>
<dd><p>Cell x cell <code>dgCMatrix</code> object containing velocity
information. Shows velocity grid-arrow layer when specified. Default
<code>NULL</code> does not show velocity.</p></dd>


<dt id="arg-bycluster">byCluster<a class="anchor" aria-label="anchor" href="#arg-bycluster"></a></dt>
<dd><p>Default <code>NULL</code> to generate one plot with all cells.
Set <code>"all"</code> to split cells in plot by cluster and returns a list of
subplots for each cluster as well as the plot including all cells. Otherwise,
a vector of cluster names to generate a list of subplots for the specified
clusters.</p></dd>


<dt id="arg-processed">processed<a class="anchor" aria-label="anchor" href="#arg-processed"></a></dt>
<dd><p>Logical. Whether the input matrix is already processed.
<code>TRUE</code> will bypass internal preprocessing and input matrix will be
directly used for similarity calculation. Default <code>FALSE</code> and raw count
input is recommended. If missing in call, using <code>slot = "counts"</code> in
"Seurat" method or using <code>assay.type = "counts"</code> in
"SingleCellExperiment" method will force this argument to be <code>FALSE</code> and
others for <code>TRUE</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Similarity calculation method. Default <code>"euclidean"</code>.
Choose from <code>"euclidean"</code>, <code>"cosine"</code>, <code>"pearson"</code>,
<code>"spearman"</code>.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>Whether to force calculate the similarity when more then 500
features are detected, which is generally not recommended. Default
<code>FALSE</code>.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Gaussian kernel parameter that controls the effect of variance.
Only effective when using a distance metric (i.e. <code>method</code> is
<code>"euclidian"</code> or <code>"cosine"</code>). Larger values tighten the dot
spreading on figure. Default <code>0.08</code>.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Whether to min-max scale the distance matrix by clusters.
Default <code>TRUE</code>.</p></dd>


<dt id="arg-dotcolorby">dotColorBy<a class="anchor" aria-label="anchor" href="#arg-dotcolorby"></a></dt>
<dd><p>A vector/factor for coloring dots, can be either categorical
(must be character or factor) or continuous. Default <code>NULL</code>.</p></dd>


<dt id="arg-dotcolor">dotColor<a class="anchor" aria-label="anchor" href="#arg-dotcolor"></a></dt>
<dd><p>Character vector of color codes. When <code>dotColorBy</code> is
<code>NULL</code>, use one or as many colors as the number of cells. If
<code>dotColorBy</code> is categorical, specify as many colors
as the number of categories in <code>dotColorBy</code> or ggplot2 categorical
color palette is used by default. If <code>dotColorBy</code> is continuous, specify
together with <code>breaks</code> argument.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>Color palette to use when <code>dotColorBy</code> is given. Default
<code>"D"</code> (viridis) for continuous value and ggplot2 default for categorical
value. See detail for alternatives.</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>Sets the order of colors in the scale. Default <code>1</code>
orders as palette default. If <code>-1</code>, the order of colors is reversed.</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>Number of breaks for continuous color scale passed to
non-interactive "plot3D::scatter3D" call. Default <code>NULL</code>.</p></dd>


<dt id="arg-legendtitle">legendTitle<a class="anchor" aria-label="anchor" href="#arg-legendtitle"></a></dt>
<dd><p>Title on the legend/colorbar. Default <code>NULL</code> uses
<code>"cluster"</code> if <code>dotColorBy</code> is missing (default); user-end variable
expression if <code>dotColorBy</code> is directly specified from
plotQuaternary.default method; variable name if <code>dotColorBy</code> is
specified from Seurat or SingleCellExperiment method.</p></dd>


<dt id="arg-returndata">returnData<a class="anchor" aria-label="anchor" href="#arg-returndata"></a></dt>
<dd><p>Logical. Whether to return similarity and aggregated
velocity data if applicable instead of generating plot. Default <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>By default, a "ggplot" object when <code>byCluster</code> is not specified,
a list of "ggplot" object when <code>byCluster</code> is specified. When
<code>interactive = TRUE</code>, a "plotly" object is returned. When
<code>returnData = TRUE</code>, a list of similarity matrix and aggregated velocity
matrix is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>Argument inheritance</b> - For matrix/dgCMatrix ("default" method), we
first calculate the similarity matrix and obtain a "simMat" object. Then the
"simMat" method is internally called. For data container objects (e.g.
Seurat), we obtain the correct data matrix first and then call the "default"
method. The arguments inherits as the flow described above.</p>
<p><b>The calculation of similarity matrix</b> - The similarity is calculated
either by converting a distance metric ("euclidean" or "cosine") with
Gaussian kernel, or directly computed with correlation metrics ("pearson" or
"spearman"). The centroid of each terminal is obtained first, and the
specified metric from each cell to each terminal is calculated. The
similarity matrix (n cells by v terminals) is lastly normalized to sum to 1
for each cell, so it becomes a baricentric coordinate.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other plotTernary:
<code><a href="plotTernary.Seurat.html">plotTernary.Seurat</a>()</code>,
<code><a href="plotTernary.SingleCellExperiment.html">plotTernary.SingleCellExperiment</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="selectTopFeatures.html">selectTopFeatures</a></span><span class="op">(</span><span class="va">rnaRaw</span>, <span class="va">rnaCluster</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "CH".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-in"><span><span class="fu">plotTernary</span><span class="op">(</span><span class="va">rnaRaw</span>, <span class="va">rnaCluster</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span>, <span class="va">gene</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTernary-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yichen Wang, Jialin Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

